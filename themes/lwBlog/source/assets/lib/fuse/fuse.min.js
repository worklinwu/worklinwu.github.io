/**
 * @license
 * Fuse - Lightweight fuzzy-search
 *
 * Copyright (c) 2012 Kirollos Risk <kirollos@gmail.com>.
 * All Rights Reserved. Apache Software License 2.0
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(a){function e(a,b){this.list=a,this.options=b=b||{};var c,d,f,g;for(c=0,g=["sort","includeScore","shouldSort"],d=g.length;d>c;c++)f=g[c],this.options[f]=f in b?b[f]:e.defaultOptions[f];for(c=0,g=["searchFn","sortFn","keys","getFn"],d=g.length;d>c;c++)f=g[c],this.options[f]=b[f]||e.defaultOptions[f]}var c,d,b=function(a,c){if(c=c||{},this.options=c,this.options.location=c.location||b.defaultOptions.location,this.options.distance="distance"in c?c.distance:b.defaultOptions.distance,this.options.threshold="threshold"in c?c.threshold:b.defaultOptions.threshold,this.options.maxPatternLength=c.maxPatternLength||b.defaultOptions.maxPatternLength,this.pattern=c.caseSensitive?a:a.toLowerCase(),this.patternLen=a.length,this.patternLen>this.options.maxPatternLength)throw new Error("Pattern length is too long");this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet()};b.defaultOptions={location:0,distance:100,threshold:.6,maxPatternLength:32},b.prototype._calculatePatternAlphabet=function(){var a={},b=0;for(b=0;b<this.patternLen;b++)a[this.pattern.charAt(b)]=0;for(b=0;b<this.patternLen;b++)a[this.pattern.charAt(b)]|=1<<this.pattern.length-b-1;return a},b.prototype._bitapScore=function(a,b){var c=a/this.patternLen,d=Math.abs(this.options.location-b);return this.options.distance?c+d/this.options.distance:d?1:c},b.prototype.search=function(a){if(a=this.options.caseSensitive?a:a.toLowerCase(),this.pattern===a)return{isMatch:!0,score:0};var b,c,h,i,k,l,m,n,o,d=a.length,e=this.options.location,f=this.options.threshold,g=a.indexOf(this.pattern,e),j=this.patternLen+d,p=1,q=[];for(-1!=g&&(f=Math.min(this._bitapScore(0,g),f),g=a.lastIndexOf(this.pattern,e+this.patternLen),-1!=g&&(f=Math.min(this._bitapScore(0,g),f))),g=-1,b=0;b<this.patternLen;b++){for(h=0,i=j;i>h;)this._bitapScore(b,e+i)<=f?h=i:j=i,i=Math.floor((j-h)/2+h);for(j=i,k=Math.max(1,e-i+1),l=Math.min(e+i,d)+this.patternLen,m=Array(l+2),m[l+1]=(1<<b)-1,c=l;c>=k;c--)if(o=this.patternAlphabet[a.charAt(c-1)],m[c]=0===b?(1|m[c+1]<<1)&o:(1|m[c+1]<<1)&o|(1|(n[c+1]|n[c])<<1)|n[c+1],m[c]&this.matchmask&&(p=this._bitapScore(b,c-1),f>=p)){if(f=p,g=c-1,q.push(g),!(g>e))break;k=Math.max(1,2*e-g)}if(this._bitapScore(b+1,e)>f)break;n=m}return{isMatch:g>=0,score:p}},c=function(a,b,e){var f,g,h,i,j,k;if(b){if(h=b.indexOf("."),-1!==h?(f=b.slice(0,h),g=b.slice(h+1)):f=b,i=a[f])if(g||"string"!=typeof i&&"number"!=typeof i)if(d.isArray(i))for(j=0,k=i.length;k>j;j++)c(i[j],g,e);else g&&c(i,g,e);else e.push(i)}else e.push(a);return e},d={deepValue:function(a,b){return c(a,b,[])},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)}},e.defaultOptions={id:null,caseSensitive:!1,includeScore:!1,shouldSort:!0,searchFn:b,sortFn:function(a,b){return a.score-b.score},getFn:d.deepValue,keys:[]},e.prototype.search=function(a){var c,e,k,n,q,r,s,t,b=new this.options.searchFn(a,this.options),f=this.list,g=f.length,h=this.options,i=this.options.keys,j=i.length,l=[],m={},o=[],p=function(a,c,e){if(void 0!==a&&null!==a)if("string"==typeof a)k=b.search(a),k.isMatch&&(n=m[e],n?n.score=Math.min(n.score,k.score):(m[e]={item:c,score:k.score},l.push(m[e])));else if(d.isArray(a))for(var f=0;f<a.length;f++)p(a[f],c,e)};if("string"==typeof f[0])for(q=0;g>q;q++)p(f[q],q,q);else for(q=0;g>q;q++)for(e=f[q],c=0;j>c;c++)p(h.getFn(e,i[c]),e,q);for(h.shouldSort&&l.sort(h.sortFn),r=h.includeScore?function(a){return l[a]}:function(a){return l[a].item},s=h.id?function(a){l[a].item=h.getFn(l[a].item,h.id)[0]}:function(){},q=0,t=l.length;t>q;q++)s(q),o.push(r(q));return o},"object"==typeof exports?module.exports=e:"function"==typeof define?define(function(){return e}):a.Fuse=e}(this);