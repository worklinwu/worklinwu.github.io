---
title: 我的博客的搭建教程[3]-扩展
english_title: course-static-blog-3
author: 拳头巴掌
tags: 
    - 静态博客
category: 
    - 教程
date: 2015-1-8
---

[我的博客的搭建教程-准备篇](http://www.linwu.name/articles/course-static-blog-1.html)   
[我的博客的搭建教程-Papery](http://www.linwu.name/articles/course-static-blog-2.html)   
教程写的也许不是很详细，有不懂的试下联系我。  
   
再说说博客一些锦上添花的功能。
- 侧边栏的其他文章和上下篇链接
- 支持移动端阅读
- 搜索和分页
- 添加评论支持 / 热评文章
- 添加百度统计
   
### 侧边栏的其他文章和上下篇链接
这个不难，因为前面有提到过Papery的渲染过程，程序会把所有的数据集合在一起，在编译每一个页面的时候都可以调用，那么只要加上一点逻辑就可以实现了。   
   
### 支持移动端阅读
访问我的博客的时候应该有发现侧边栏的在手机中查看的的二维码吧。二维码是用jQuery的一个插件`jquery.qrcode`实现的。扫描二维码就可以在手机上访问啦。这当然要你的模板有做响应式布局啦。
   
### 搜索和分页
这个挺好玩的。因为静态博客没有后台来处理请求，因此很多功能不能实现，例如搜索和分页。于是想了想，还是有办法实现的，那就是用`本地存储`啦。具体的步骤是这样的：   
1. 在编译过程中把数据生成到一个`data.json`的文件中。文件只保存关键数据，类似索引，不保存文章正文。
2. 页面加载的时候用ajax去请求这个文件，然后把数据存下来。 这里我用了`jStorage`的插件。
3. 因为每次更新`data.json`文件都有变化，所有要有个变量来判断是否更新本地存储的数据。 我在全局定义了一个`DB_VERISION`的变量，每次编译的时候修改他，这个会修改到Papery的源代码。
4. 有了数据后，就下来的事情就简单了，搜索和分页可以放到页面加载的过程中去执行。如果单纯的用js去检索数据显然比较费力，于是找了个插件`fuse`（一个javascript查询引擎）来解决数据检索问题。
   
### 添加评论支持 / 热评文章
有了这些感觉还是少了点什么，哦对了，那就是评论。因为这是静态博客，好在有第三方评论平台。我的博客使用的是`多说`。注册个多说的账号，配置完后，在你的页面添加下面这段，代码是官方提供的。
```html
<div class="ds-thread" data-thread-key="<%= article.id %>" data-title="<%= article.title %>" data-url="www.linwu.name/articles/<%= article.id %>.html"></div>
```   

```javascript
// 多说
var duoshuoQuery = {short_name: "xxx"};
(function () {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';
    ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
            || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
```
   
之后还可以再加一个热门评论的侧边栏，代码也是又多说提供。
```html
<div class="ds-top-threads" data-range="monthly" data-num-items="5"></div>
```
   
### 添加百度统计
为了认真做好自己的博客，关注下自己博客的访问量是又必要的。那就加个百度统计吧。   
上百度统计注册个账号，绑定自己的域名。然后加个代码就可以啦：
```javascript
<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?xxxxxxxxxxxx";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
```
   
<img src="http://7sbyz5.com1.z0.glb.clouddn.com/百度统计数据2015-1-8.png"/>   
看了博客上线后到现在的数据，我的心情哪...


